#!/bin/bash

source config.sh
source fonction.sh

echo "
**************************************************************************
**************************************************************************
*************************** Création de backups ***************************
**************************************************************************
**************************************************************************
"

date_sauvegarde=$(date +"%d-%m-%Y_%H-%M")
nom="archive"
dossier="${nom}_${date_sauvegarde}"

read -p "Donnez le chemin à backuper : " chemin
if [[ ! -d "$chemin" ]]; then
    echo -e "${erreur}Le chemin spécifié n'existe pas ou n'est pas un dossier.${blanc}"
    exit 1
fi

echo "
**************************************************************************
**************************************************************************
*************************** Création du backup ***************************
**************************************************************************
**************************************************************************
"

cp -R "$chemin" "$HOME"/"$dossier"


tar -czf "$HOME"/"$dossier".tar.gz -C "$HOME"/ "$dossier"

rm -rf "$HOME"/"$dossier"

if [[ $? -eq 0 ]]; then
    echo -e "${valid}
*************************************************************************************
********************************Backup OK !******************************************
*************************************************************************************${blanc}
"
else
    echo -e "${erreur}
*************************************************************************************
********************************Erreur la mise en place du backup********************
*************************************************************************************${blanc}
"
    exit 1
fi
echo -e "
**************************************************************************
**************************************************************************
*********************** Création du backup terminée ! ********************
**************************************************************************
**************************************************************************

**************************************************************************
* Vôtre backup ce trouve dans : ${valid}$HOME${blanc}
**************************************************************************
"
