#!/bin/bash 

source config.sh
source fonction.sh

echo "
*************************************************************************************
*************************************************************************************
********************************Test de la config reseau sur www.google.fr***********
*************************************************************************************
*************************************************************************************
"
ping -c 3 www.google.fr > /dev/null

if [[ $? -eq 0 ]]; then
    echo -e "${valid}
*************************************************************************************
********************************Config reseau OK !***********************************
*************************************************************************************${blanc}
"
else
    echo -e "${erreur}
*************************************************************************************
********************************Erreur dans la config reseau*************************
*************************************************************************************${blanc}
"
    exit 1
fi


echo "
*************************************************************************************
*************************************************************************************
********************************Installation de Apache2 Server***********************
*************************************************************************************
*************************************************************************************
"

apt update > /dev/null

apt install -y apache2 php php-mysqli php-xml php-curl php-mbstring php-gd php-intl php-imap php-zip mariadb-server || exit 1

systemctl restart apache2

if [[ $? -eq 0 ]]; then
    echo -e "${valid}
*************************************************************************************
*************************************************************************************
********************************Installation reussite********************************
*************************************************************************************
*************************************************************************************



*************************************************************************************
********** Pensez à exécuter 'mysql_secure_installation' pour sécuriser mariadb *****
*************************************************************************************${blanc}

******************************************************
Connectez-vous à cette IP sur le poste client : ******
******************************************************

${valid}$(ip a|grep brd|grep inet|tr " " "-"|cut -d "-" -f 6)${blanc}

***********************************************
Le chemin de vos pages web est ${valid}/var/www/html${blanc} ***
***********************************************
"
else
    echo -e "${erreur}
*************************************************************************************
*************************************************************************************
********************************Erreur lors de l'installation************************
*************************************************************************************
*************************************************************************************${blanc}
"
fi

echo "[Appuyer sur entrer pour continuer]"
read
